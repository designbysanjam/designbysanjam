<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
    crossorigin="anonymous"></script>

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

  <script>
    var mymodule = angular.module("kuchModule", []);

    mymodule.controller("kuchController", function ($scope, $http) {

      $scope.jsonArray = [];
      $scope.selCity;
      $scope.selSports;

      $scope.doFetchtour = function () {
        var url = "/do-fetch-all-tour?kuchCity=" + $scope.selCity + "&kuchSports=" + $scope.selSports;


        $http.get(url).then(allGoodFx, someBadFx);
        function allGoodFx(response) {
          //resp in JSON array
          //alert(JSON.stringify(response.data));
          $scope.jsonArray = response.data;
        }

        function someBadFx(response) {
          alert(JSON.stringify(response.data));
        }
      };
      //....................................................
      $scope.cities = [{}];
      $scope.doFetchAlCities = function () {
        var url = "/do-fetch-all-cities";

        $http.get(url).then(allGoodFx, someBadFx);
        function allGoodFx(response) {
          //resp in JSON array
          //  alert(JSON.stringify(response.data));
          $scope.cities = response.data;
        }

        function someBadFx(response) {
          alert(JSON.stringify(response.data));
        }
      };



      $scope.sports = [{}];
      $scope.doFetchAlSports = function () {
        var url = "/do-fetch-all-sports";

        $http.get(url).then(allGoodFx, someBadFx);
        function allGoodFx(response) {
          //resp in JSON array
        //  alert(JSON.stringify(response.data));
          $scope.sports = response.data;
        }

        function someBadFx(response) {
          alert(JSON.stringify(response.data));
        }
      };
      //==================================================
      $scope.oneRecord = {};
      $scope.doShowDetails = function (index) {
        //alert(JSON.stringify($scope.jsonArray[index]))
        $scope.oneRecord = $scope.jsonArray[index];

      }

    });


    function showUser()
    {
      let activeUser=localStorage.getItem("activeUser");
      document.getElementById("welcome").innerHTML=activeUser;
    }
  </script>


  <style>
    .services {
      background-color: #af3b49;
      font-size: 22px;
      color: white;

    }
  </style>

</head>

<body onload="showUser();" ng-app="kuchModule" ng-controller="kuchController" ng-init="doFetchAlCities(); doFetchAlSports()">
  

    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
  
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">About Us</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">Tournaments</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">Players</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">Contact Us</a>
            </li>
          </ul>
          welcome: <span id="welcome">* </span>
  
        </div>
      </div>
    </nav>

  <div class="clear">
    &nbsp;
    </div>



    <div class="container mt-12">
      <div class="row ">
        <div class="services col-md-12" style="padding:20px 0px 20px 15px">
          <center>
            Find Tournaments
          </center>
        </div>

    
          <hr />
          <center>
          <div class="col-md-4">
            
            <label for="inputSports Category" class="form-label">Sports</label>
            <select id="txtSports" class="form-select" ng-model="selSports">
              <option selected>Choose</option>
              <option ng-repeat="obj in sports" value={{obj.sports}}>{{obj.sports}}</option>
            </select>
           
            <label for="inputCity Category" class="form-label">City</label>
            <select  class="form-select" ng-model="selCity">
              <option selected>Choose City</option>
              <option ng-repeat="obj in cities" value={{obj.city}}>{{obj.city}}</option>
            </select>
           
            <!-- <div class="col-md-4"> -->
            <!-- <label for="inputSports Category" class="form-label">City</label> -->
            <!-- <select ng-model="selCity"> -->
              <!-- <option value="">select city</option> -->
              <!-- <option ng-repeat="obj in cities" value={{obj.city}}>{{obj.city}}</option> -->
            <!-- </select> -->
          </div>
       

          <div class="clear">
            &nbsp;
            </div>

          <div class="col-md-4">
            <input type="button" value="Find Tournaments" class="btn btn-primary" ng-click="doFetchtour();" />
          </div>
        </center>
          <div class="container">
            <div class="row">
              <div class="col-md-3  p-3 mb-2" ng-repeat="obj in jsonArray">

                <div class="card">


                  <!-- <img src={{obj.picurl}} height="150" class="card-img-top" alt="..." /> -->

                  <div class="card-body">
                    <h5 class="card-title">
                      <p class="card-text">
                      <div>Sports</div>
                      {{obj.sport}}
                      </p>
                      <div>Event Name</div>
                      {{obj.eventname}}
                    </h5>
                    <p class="card-text">
                    <div>Event Date</div>
                    {{obj.eventdate}}
                    </p>

                    <a href="#" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#detailsModal"
                      ng-click="doShowDetails($index);">Details</a>
                  </div>
                </div>
              </div>
            </div>
          </div>


          </div>
          </div>

          <nav class="navbar bg-body-primary  mt-5" style="transform: translateY(50px); background-color: #af3b49;">
            <div class="container-fluid">
              <span class="navbar-brand mb-0 h1 text-white" >Developer:@designbysanjam</span>
              <!-- <span  class="navbar-brand mb-0 h1 text-white text-md-end">About</span> -->
        
            </div>
          </nav>
          <!-- ************************** -->

          <!-- Modal -->
          <div class="modal fade" id="detailsModal" tabindex="-1" aria-labelledby="exampleModalLabel"
            aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="exampleModalLabel">EVENT DETAILS</h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                  <!-- <p>
               <img src={{oneRecord.picurl}} height="150" width="150"/>
          </p> -->
                  <p>
                    email: {{oneRecord.email}} <br>
                    eventname: {{oneRecord.eventname}}<br>
                    eventdate: {{oneRecord.eventdate}}<br>
                    eventtime: {{oneRecord.eventtime}}<br>
                    eventaddress: {{oneRecord.eventaddress}}<br>
                    eventcity: {{oneRecord.eventcity}}<br>
                    sports: {{oneRecord.sports}}<br>
                    minage: {{oneRecord.minage}}<br>
                    maxage: {{oneRecord.maxage}}<br>
                    lastdate: {{oneRecord.lastdate}}<br>
                    fees: {{oneRecord.fees}}<br>
                    prizemoney: {{oneRecord.prizemoney}}<br>
                    contactperson: {{oneRecord.contactperson}}<br>


                  </p>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
               
                </div>
              </div>
            </div>
          </div>


        
  
   

        

</body>

</html>